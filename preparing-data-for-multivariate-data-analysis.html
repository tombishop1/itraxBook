<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.1 Preparing Data for Multivariate Data Analysis | Using Itrax Data in R</title>
  <meta name="description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="6.1 Preparing Data for Multivariate Data Analysis | Using Itrax Data in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.1 Preparing Data for Multivariate Data Analysis | Using Itrax Data in R" />
  
  <meta name="twitter:description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  

<meta name="author" content="Thomas Bishop" />


<meta name="date" content="2021-12-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multivariate-methods.html"/>
<link rel="next" href="principal-component-analysis.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Using Itrax Data in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="the-itraxr-package.html"><a href="the-itraxr-package.html"><i class="fa fa-check"></i><b>0.1</b> The itraxR Package</a></li>
<li class="chapter" data-level="0.2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>0.2</b> Prerequisites</a></li>
<li class="chapter" data-level="0.3" data-path="example-data.html"><a href="example-data.html"><i class="fa fa-check"></i><b>0.3</b> Example Data</a></li>
<li class="chapter" data-level="0.4" data-path="utility-data.html"><a href="utility-data.html"><i class="fa fa-check"></i><b>0.4</b> Utility Data</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Data Structure</a><ul>
<li class="chapter" data-level="1.1" data-path="metadata.html"><a href="metadata.html"><i class="fa fa-check"></i><b>1.1</b> Metadata</a></li>
<li class="chapter" data-level="1.2" data-path="xrf-data.html"><a href="xrf-data.html"><i class="fa fa-check"></i><b>1.2</b> XRF Data</a></li>
<li class="chapter" data-level="1.3" data-path="optical-images.html"><a href="optical-images.html"><i class="fa fa-check"></i><b>1.3</b> Optical Images</a></li>
<li class="chapter" data-level="1.4" data-path="radiographic-images.html"><a href="radiographic-images.html"><i class="fa fa-check"></i><b>1.4</b> Radiographic Images</a></li>
<li class="chapter" data-level="1.5" data-path="magnetic-susceptability.html"><a href="magnetic-susceptability.html"><i class="fa fa-check"></i><b>1.5</b> Magnetic Susceptability</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing.html"><a href="importing.html"><i class="fa fa-check"></i><b>2</b> Importing Data</a><ul>
<li class="chapter" data-level="2.1" data-path="metadata-1.html"><a href="metadata-1.html"><i class="fa fa-check"></i><b>2.1</b> Metadata</a></li>
<li class="chapter" data-level="2.2" data-path="xrf-data-1.html"><a href="xrf-data-1.html"><i class="fa fa-check"></i><b>2.2</b> XRF Data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="xrf-data-1.html"><a href="xrf-data-1.html#processed-data"><i class="fa fa-check"></i><b>2.2.1</b> Processed Data</a></li>
<li class="chapter" data-level="2.2.2" data-path="xrf-data-1.html"><a href="xrf-data-1.html#joining-xrf-data"><i class="fa fa-check"></i><b>2.2.2</b> Joining XRF Data</a></li>
<li class="chapter" data-level="2.2.3" data-path="xrf-data-1.html"><a href="xrf-data-1.html#raw-data"><i class="fa fa-check"></i><b>2.2.3</b> Raw Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="optical-images-1.html"><a href="optical-images-1.html"><i class="fa fa-check"></i><b>2.3</b> Optical Images</a></li>
<li class="chapter" data-level="2.4" data-path="radiographic-images-1.html"><a href="radiographic-images-1.html"><i class="fa fa-check"></i><b>2.4</b> Radiographic Images</a></li>
<li class="chapter" data-level="2.5" data-path="importing-everything.html"><a href="importing-everything.html"><i class="fa fa-check"></i><b>2.5</b> Importing Everything</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>3</b> Tidying Data</a><ul>
<li class="chapter" data-level="3.1" data-path="low-count-rates.html"><a href="low-count-rates.html"><i class="fa fa-check"></i><b>3.1</b> Low Count Rates</a></li>
<li class="chapter" data-level="3.2" data-path="model-errors-mse.html"><a href="model-errors-mse.html"><i class="fa fa-check"></i><b>3.2</b> Model Errors (MSE)</a></li>
<li class="chapter" data-level="3.3" data-path="surface-slope.html"><a href="surface-slope.html"><i class="fa fa-check"></i><b>3.3</b> Surface Slope</a></li>
<li class="chapter" data-level="3.4" data-path="combining-validity-flags.html"><a href="combining-validity-flags.html"><i class="fa fa-check"></i><b>3.4</b> Combining “Validity” Flags</a></li>
<li class="chapter" data-level="3.5" data-path="tube-current.html"><a href="tube-current.html"><i class="fa fa-check"></i><b>3.5</b> Tube current</a></li>
<li class="chapter" data-level="3.6" data-path="dead-time.html"><a href="dead-time.html"><i class="fa fa-check"></i><b>3.6</b> Dead Time</a></li>
<li class="chapter" data-level="3.7" data-path="correcting-for-water-content.html"><a href="correcting-for-water-content.html"><i class="fa fa-check"></i><b>3.7</b> Correcting for Water Content</a></li>
<li class="chapter" data-level="3.8" data-path="correcting-grain-size.html"><a href="correcting-grain-size.html"><i class="fa fa-check"></i><b>3.8</b> Correcting Grain Size</a></li>
<li class="chapter" data-level="3.9" data-path="uncertainties.html"><a href="uncertainties.html"><i class="fa fa-check"></i><b>3.9</b> Uncertainties</a></li>
<li class="chapter" data-level="3.10" data-path="noisy-data.html"><a href="noisy-data.html"><i class="fa fa-check"></i><b>3.10</b> Noisy Data</a></li>
<li class="chapter" data-level="3.11" data-path="reversing-data.html"><a href="reversing-data.html"><i class="fa fa-check"></i><b>3.11</b> Reversing Data</a></li>
<li class="chapter" data-level="3.12" data-path="visualising-raw-data.html"><a href="visualising-raw-data.html"><i class="fa fa-check"></i><b>3.12</b> Visualising Raw Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>4</b> Plotting</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting-xrf-data.html"><a href="plotting-xrf-data.html"><i class="fa fa-check"></i><b>4.1</b> Plotting XRF Data</a></li>
<li class="chapter" data-level="4.2" data-path="plotting-images.html"><a href="plotting-images.html"><i class="fa fa-check"></i><b>4.2</b> Plotting Images</a></li>
<li class="chapter" data-level="4.3" data-path="combining-images-with-xrf-data.html"><a href="combining-images-with-xrf-data.html"><i class="fa fa-check"></i><b>4.3</b> Combining Images with XRF Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transforming-data.html"><a href="transforming-data.html"><i class="fa fa-check"></i><b>5</b> Transforming Data</a><ul>
<li class="chapter" data-level="5.1" data-path="ratios-and-normalisation.html"><a href="ratios-and-normalisation.html"><i class="fa fa-check"></i><b>5.1</b> Ratios and Normalisation</a></li>
<li class="chapter" data-level="5.2" data-path="running-mean-and-other-window-functions.html"><a href="running-mean-and-other-window-functions.html"><i class="fa fa-check"></i><b>5.2</b> Running Mean and Other Window Functions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-methods.html"><a href="multivariate-methods.html"><i class="fa fa-check"></i><b>6</b> Multivariate Methods</a><ul>
<li class="chapter" data-level="6.1" data-path="preparing-data-for-multivariate-data-analysis.html"><a href="preparing-data-for-multivariate-data-analysis.html"><i class="fa fa-check"></i><b>6.1</b> Preparing Data for Multivariate Data Analysis</a></li>
<li class="chapter" data-level="6.2" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>6.2</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="6.3" data-path="using-ordr-for-pca.html"><a href="using-ordr-for-pca.html"><i class="fa fa-check"></i><b>6.3</b> Using <code>ordr</code> for PCA</a></li>
<li class="chapter" data-level="6.4" data-path="unconstrained-cluster-analysis.html"><a href="unconstrained-cluster-analysis.html"><i class="fa fa-check"></i><b>6.4</b> Unconstrained Cluster Analysis</a></li>
<li class="chapter" data-level="6.5" data-path="constrained-cluster-analysis.html"><a href="constrained-cluster-analysis.html"><i class="fa fa-check"></i><b>6.5</b> Constrained Cluster Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="calibrating-data.html"><a href="calibrating-data.html"><i class="fa fa-check"></i><b>7</b> Calibrating Data</a><ul>
<li class="chapter" data-level="7.1" data-path="suitable-methods.html"><a href="suitable-methods.html"><i class="fa fa-check"></i><b>7.1</b> Suitable Methods</a></li>
<li class="chapter" data-level="7.2" data-path="preparing-data.html"><a href="preparing-data.html"><i class="fa fa-check"></i><b>7.2</b> Preparing Data</a></li>
<li class="chapter" data-level="7.3" data-path="linear-methods.html"><a href="linear-methods.html"><i class="fa fa-check"></i><b>7.3</b> Linear Methods</a></li>
<li class="chapter" data-level="7.4" data-path="log-ratio-methods.html"><a href="log-ratio-methods.html"><i class="fa fa-check"></i><b>7.4</b> Log-Ratio Methods</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exporting-data.html"><a href="exporting-data.html"><i class="fa fa-check"></i><b>8</b> Exporting Data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using Itrax Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="preparing-data-for-multivariate-data-analysis" class="section level2">
<h2><span class="header-section-number">6.1</span> Preparing Data for Multivariate Data Analysis</h2>
<p>Where multivariate methods (cluster analysis, principal components analysis, correlation matrices) are required, it is usually necessary to transform data and treat them in a special way to avoid breaking the assumptions of a method or drawing erroneous conclusions. This is because the constant sum constraint that defines compositional data - put simply, if one element increases in proportion, an equal decrease must occur in the remaining elements that make up the composition. This is further complicated by unobserved elements, dimensionless (i.e. calibrated) data, and observations below the limit of detection. The package <code>compositions</code> deals with much of these issues, including any necessary transformation, and ensures that the data are treated differently by functions like <code>princomp()</code> and <code>dist()</code>, e.g. <code>compositions::princomp.acomp()</code> by setting a <code>class</code> attribute and providing modified functions.</p>
<p>It’s worth spending some time getting familiar with the documentation for <code>compositions</code>, and possibly the wider literature around compositional data analysis. Several different methods are provided depending on the nature of the compositional data - in these examples, we use the <code>acomp()</code> but other methods are available. This package also deals with the variety of different types of zero and missing values. For these count data we deal with values that are below the limit of detection by letting the <code>compositions</code> package know the detection limit. For these count data, the detection limit is <code>1</code>, and thus is coded as <code>-1</code>. This allows <code>zeroreplace()</code> to correctly deal with this problem.</p>
<p>In order to correctly identify the observations to their original data source, it is necessary to use row names that uniquely identify observations. For single scans this is not usually an issue — the <code>depth</code> or <code>position</code> variable can be used. However, where a dataset is a composition of multiple cores, you may find that there are multiple observations for a particular depth where cores overlap. We don’t usually use row names when working in the <code>tidyverse</code> style, but because were going to be using base functions like <code>princomp()</code> and <code>dist()</code>, they may become necessary.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="preparing-data-for-multivariate-data-analysis.html#cb55-1"></a>CD166_<span class="dv">19</span>_xrf_acomp &lt;-<span class="st"> </span>CD166_<span class="dv">19</span>_xrf <span class="op">%&gt;%</span></span>
<span id="cb55-2"><a href="preparing-data-for-multivariate-data-analysis.html#cb55-2"></a><span class="st">  </span><span class="kw">filter</span>(qc <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb55-3"><a href="preparing-data-for-multivariate-data-analysis.html#cb55-3"></a><span class="st">  </span><span class="kw">select</span>(<span class="kw">any_of</span>(<span class="kw">c</span>(elementsList, <span class="st">&quot;depth&quot;</span>, <span class="st">&quot;label&quot;</span>))) <span class="op">%&gt;%</span></span>
<span id="cb55-4"><a href="preparing-data-for-multivariate-data-analysis.html#cb55-4"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">paste0</span>(label, <span class="st">&quot;_&quot;</span>, depth)) <span class="op">%&gt;%</span></span>
<span id="cb55-5"><a href="preparing-data-for-multivariate-data-analysis.html#cb55-5"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">c</span>(<span class="st">&quot;depth&quot;</span>, <span class="st">&quot;label&quot;</span>)) <span class="op">%&gt;%</span></span>
<span id="cb55-6"><a href="preparing-data-for-multivariate-data-analysis.html#cb55-6"></a><span class="st">  </span><span class="kw">column_to_rownames</span>(<span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb55-7"><a href="preparing-data-for-multivariate-data-analysis.html#cb55-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">everything</span>(), <span class="cf">function</span>(x){<span class="kw">ifelse</span>(x <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">-1</span>, x)})) <span class="op">%&gt;%</span></span>
<span id="cb55-8"><a href="preparing-data-for-multivariate-data-analysis.html#cb55-8"></a><span class="st">  </span><span class="kw">acomp</span>()</span>
<span id="cb55-9"><a href="preparing-data-for-multivariate-data-analysis.html#cb55-9"></a><span class="kw">head</span>(CD166_<span class="dv">19</span>_xrf_acomp)</span></code></pre></div>
<pre><code>##      Al             Si            P               S               Cl           
## S1_2 &quot;0.0002804828&quot; &quot;0.001505750&quot; &quot;&lt;4.920751e-06&quot; &quot;&lt;4.920751e-06&quot; &quot;0.007445097&quot;
## S1_3 &quot;0.0003343092&quot; &quot;0.001490838&quot; &quot;&lt;4.517691e-06&quot; &quot; 1.445661e-04&quot; &quot;0.006641006&quot;
## S1_4 &quot;0.0001227370&quot; &quot;0.000972455&quot; &quot;&lt;4.720655e-06&quot; &quot; 9.913376e-05&quot; &quot;0.006193500&quot;
## S1_5 &quot;0.0002582984&quot; &quot;0.001135538&quot; &quot;&lt;4.873556e-06&quot; &quot; 1.803216e-04&quot; &quot;0.008479987&quot;
## S1_6 &quot;0.0001333485&quot; &quot;0.001713775&quot; &quot;&lt;4.938833e-06&quot; &quot; 1.382873e-04&quot; &quot;0.007783600&quot;
## S1_7 &quot;0.0003509832&quot; &quot;0.001642797&quot; &quot;&lt;4.874767e-06&quot; &quot; 2.876113e-04&quot; &quot;0.007824001&quot;
##      Ar            K            Ca          Sc              Ti           
## S1_2 &quot;0.002927847&quot; &quot;0.01293173&quot; &quot;0.7100004&quot; &quot; 6.889052e-05&quot; &quot;0.008886877&quot;
## S1_3 &quot;0.002285952&quot; &quot;0.01074307&quot; &quot;0.7361036&quot; &quot;&lt;4.517691e-06&quot; &quot;0.009582023&quot;
## S1_4 &quot;0.002619964&quot; &quot;0.01069228&quot; &quot;0.7231761&quot; &quot;&lt;4.720655e-06&quot; &quot;0.009587651&quot;
## S1_5 &quot;0.002880271&quot; &quot;0.01436237&quot; &quot;0.6622139&quot; &quot; 5.165969e-04&quot; &quot;0.008899113&quot;
## S1_6 &quot;0.002489172&quot; &quot;0.01570055&quot; &quot;0.6528297&quot; &quot; 6.914366e-05&quot; &quot;0.009497375&quot;
## S1_7 &quot;0.002846864&quot; &quot;0.01645721&quot; &quot;0.6536770&quot; &quot;&lt;4.874767e-06&quot; &quot;0.010037146&quot;
##      V               Cr            Mn            Fe          Ni            
## S1_2 &quot; 4.330261e-04&quot; &quot;0.001604165&quot; &quot;0.002750700&quot; &quot;0.1795779&quot; &quot;0.0005117581&quot;
## S1_3 &quot; 9.938921e-05&quot; &quot;0.001359825&quot; &quot;0.002182045&quot; &quot;0.1624200&quot; &quot;0.0006053706&quot;
## S1_4 &quot; 3.540491e-04&quot; &quot;0.001444520&quot; &quot;0.002289518&quot; &quot;0.1676399&quot; &quot;0.0006797744&quot;
## S1_5 &quot; 4.337464e-04&quot; &quot;0.002144364&quot; &quot;0.003596684&quot; &quot;0.2159131&quot; &quot;0.0008090102&quot;
## S1_6 &quot; 5.284551e-04&quot; &quot;0.001980472&quot; &quot;0.003911555&quot; &quot;0.2236452&quot; &quot;0.0007457637&quot;
## S1_7 &quot;&lt;4.874767e-06&quot; &quot;0.002144898&quot; &quot;0.003894939&quot; &quot;0.2227476&quot; &quot;0.0006093459&quot;
##      Cu             Zn            Ga              Ge              Br           
## S1_2 &quot;0.0011317728&quot; &quot;0.001318761&quot; &quot; 2.361961e-04&quot; &quot; 1.968301e-04&quot; &quot;0.002977055&quot;
## S1_3 &quot;0.0006776537&quot; &quot;0.000555676&quot; &quot;&lt;4.517691e-06&quot; &quot; 1.942607e-04&quot; &quot;0.002484730&quot;
## S1_4 &quot;0.0009724550&quot; &quot;0.001128237&quot; &quot;&lt;4.720655e-06&quot; &quot;&lt;4.720655e-06&quot; &quot;0.002874879&quot;
## S1_5 &quot;0.0013451013&quot; &quot;0.001169653&quot; &quot;&lt;4.873556e-06&quot; &quot;&lt;4.873556e-06&quot; &quot;0.003211673&quot;
## S1_6 &quot;0.0012347081&quot; &quot;0.001452017&quot; &quot; 1.975533e-04&quot; &quot; 2.370640e-04&quot; &quot;0.003501632&quot;
## S1_7 &quot;0.0010578245&quot; &quot;0.001384434&quot; &quot; 3.899814e-05&quot; &quot; 5.605982e-04&quot; &quot;0.002841989&quot;
##      Rb             Sr           Y              Zr             Pd            
## S1_2 &quot;0.0003739771&quot; &quot;0.04517742&quot; &quot;0.0006889052&quot; &quot;0.0015844819&quot; &quot;0.0003838186&quot;
## S1_3 &quot;0.0013327189&quot; &quot;0.04356861&quot; &quot;0.0005376053&quot; &quot;0.0012649536&quot; &quot;0.0003388268&quot;
## S1_4 &quot;0.0014775651&quot; &quot;0.04692331&quot; &quot;0.0005051101&quot; &quot;0.0022423112&quot; &quot;0.0003115632&quot;
## S1_5 &quot;0.0014815609&quot; &quot;0.05013427&quot; &quot;0.0008772400&quot; &quot;0.0007797689&quot; &quot;0.0001510802&quot;
## S1_6 &quot;0.0015705488&quot; &quot;0.04897840&quot; &quot;0.0005235163&quot; &quot;0.0015409158&quot; &quot;0.0003555959&quot;
## S1_7 &quot;0.0016427966&quot; &quot;0.04841131&quot; &quot;0.0002534879&quot; &quot;0.0015550507&quot; &quot;0.0001511178&quot;
##      Cd             I              Cs              Ba            
## S1_2 &quot;0.0001673055&quot; &quot;0.0002361961&quot; &quot;&lt;4.920751e-06&quot; &quot;0.0002361961&quot;
## S1_3 &quot;0.0002484730&quot; &quot;0.0003614153&quot; &quot;&lt;4.517691e-06&quot; &quot;0.0001129423&quot;
## S1_4 &quot;0.0001132957&quot; &quot;0.0003162839&quot; &quot;&lt;4.720655e-06&quot; &quot;0.0002832393&quot;
## S1_5 &quot;0.0001657009&quot; &quot;0.0001120918&quot; &quot;&lt;4.873556e-06&quot; &quot;0.0006433093&quot;
## S1_6 &quot;0.0001382873&quot; &quot;0.0002864523&quot; &quot;&lt;4.938833e-06&quot; &quot;0.0004593114&quot;
## S1_7 &quot;0.0002729870&quot; &quot;0.0001462430&quot; &quot;&lt;4.874767e-06&quot; &quot;0.0008384600&quot;
##      Nd             Sm             Yb             Ta            W            
## S1_2 &quot;0.0003296903&quot; &quot;2.263546e-04&quot; &quot;0.0013876519&quot; &quot;0.003818503&quot; &quot;0.009934997&quot;
## S1_3 &quot;0.0001987784&quot; &quot;1.761900e-04&quot; &quot;0.0007137952&quot; &quot;0.003175937&quot; &quot;0.009107666&quot;
## S1_4 &quot;0.0003540491&quot; &quot;3.021219e-04&quot; &quot;0.0010291028&quot; &quot;0.003748200&quot; &quot;0.010196615&quot;
## S1_5 &quot;0.0002046893&quot; &quot;1.754480e-04&quot; &quot;0.0007943896&quot; &quot;0.004478798&quot; &quot;0.011423614&quot;
## S1_6 &quot;0.0004790668&quot; &quot;5.926599e-05&quot; &quot;0.0009087452&quot; &quot;0.004207885&quot; &quot;0.011537113&quot;
## S1_7 &quot;0.0004484786&quot; &quot;1.169944e-04&quot; &quot;0.0012089423&quot; &quot;0.004514034&quot; &quot;0.010934103&quot;
##      Pb              Bi            
## S1_2 &quot;&lt;4.920751e-06&quot; &quot;0.0006692222&quot;
## S1_3 &quot; 5.872999e-05&quot; &quot;0.0008990206&quot;
## S1_4 &quot; 7.175396e-04&quot; &quot;0.0006325678&quot;
## S1_5 &quot; 2.631720e-04&quot; &quot;0.0007651482&quot;
## S1_6 &quot; 2.666970e-04&quot; &quot;0.0008988675&quot;
## S1_7 &quot; 3.656075e-04&quot; &quot;0.0007360899&quot;
## attr(,&quot;class&quot;)
## [1] &quot;acomp&quot;</code></pre>
<p>Where it is necessary to keep some (or all) of the other information, this can be re-joined to the <code>acomp()</code> object, but only if it’s <code>acomp</code> class is removed. For example:</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-1"></a>CD166_<span class="dv">19</span>_xrf_acomp_meta &lt;-<span class="st"> </span><span class="kw">full_join</span>(CD166_<span class="dv">19</span>_xrf <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb57-2"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-2"></a><span class="st">            </span><span class="kw">filter</span>(qc <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb57-3"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-3"></a><span class="st">            </span><span class="kw">select</span>(<span class="kw">any_of</span>(elementsList)) <span class="op">%&gt;%</span></span>
<span id="cb57-4"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-4"></a><span class="st">            </span><span class="kw">mutate</span>(<span class="kw">across</span>(<span class="kw">everything</span>(), <span class="cf">function</span>(x){<span class="kw">ifelse</span>(x <span class="op">==</span><span class="st"> </span><span class="dv">0</span>, <span class="dv">-1</span>, x)})) <span class="op">%&gt;%</span></span>
<span id="cb57-5"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-5"></a><span class="st">            </span><span class="kw">acomp</span>() <span class="op">%&gt;%</span></span>
<span id="cb57-6"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-6"></a><span class="st">            </span><span class="kw">zeroreplace</span>() <span class="op">%&gt;%</span></span>
<span id="cb57-7"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-7"></a><span class="st">            </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb57-8"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-8"></a><span class="st">            </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">rownames</span>(.)), </span>
<span id="cb57-9"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-9"></a>          CD166_<span class="dv">19</span>_xrf <span class="op">%&gt;%</span></span>
<span id="cb57-10"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-10"></a><span class="st">            </span><span class="kw">filter</span>(qc <span class="op">==</span><span class="st"> </span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span></span>
<span id="cb57-11"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-11"></a><span class="st">            </span><span class="kw">select</span>(<span class="op">-</span><span class="kw">any_of</span>(elementsList)) <span class="op">%&gt;%</span></span>
<span id="cb57-12"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-12"></a><span class="st">            </span><span class="kw">mutate</span>(<span class="dt">id =</span> <span class="kw">rownames</span>(.)), </span>
<span id="cb57-13"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-13"></a>          <span class="dt">by =</span> <span class="st">&quot;id&quot;</span>) <span class="op">%&gt;%</span></span>
<span id="cb57-14"><a href="preparing-data-for-multivariate-data-analysis.html#cb57-14"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>id)</span></code></pre></div>
<pre><code>## Warning in acomp(.): Negative values in composition are used as detection limits</code></pre>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multivariate-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="principal-component-analysis.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["itraxBook.pdf", "itraxBook.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
