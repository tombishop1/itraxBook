<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>7.3 Preparing Data | Using Itrax Data in R</title>
  <meta name="description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  <meta name="generator" content="bookdown 0.46 and GitBook 2.6.7" />

  <meta property="og:title" content="7.3 Preparing Data | Using Itrax Data in R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="7.3 Preparing Data | Using Itrax Data in R" />
  
  <meta name="twitter:description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  

<meta name="author" content="Thomas Bishop" />


<meta name="date" content="2025-12-21" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="selecting-samples.html"/>
<link rel="next" href="linear-methods.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>
<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Using Itrax Data in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="0.1" data-path="the-itraxr-package.html"><a href="the-itraxr-package.html"><i class="fa fa-check"></i><b>0.1</b> The itraxR Package</a></li>
<li class="chapter" data-level="0.2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>0.2</b> Prerequisites</a></li>
<li class="chapter" data-level="0.3" data-path="example-data.html"><a href="example-data.html"><i class="fa fa-check"></i><b>0.3</b> Example Data</a></li>
<li class="chapter" data-level="0.4" data-path="utility-data.html"><a href="utility-data.html"><i class="fa fa-check"></i><b>0.4</b> Utility Data</a></li>
<li class="chapter" data-level="0.5" data-path="citing-this-work.html"><a href="citing-this-work.html"><i class="fa fa-check"></i><b>0.5</b> Citing This Work</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Data Structure</a>
<ul>
<li class="chapter" data-level="1.1" data-path="metadata.html"><a href="metadata.html"><i class="fa fa-check"></i><b>1.1</b> Metadata</a></li>
<li class="chapter" data-level="1.2" data-path="xrf-data.html"><a href="xrf-data.html"><i class="fa fa-check"></i><b>1.2</b> XRF Data</a></li>
<li class="chapter" data-level="1.3" data-path="optical-images.html"><a href="optical-images.html"><i class="fa fa-check"></i><b>1.3</b> Optical Images</a></li>
<li class="chapter" data-level="1.4" data-path="radiographic-images.html"><a href="radiographic-images.html"><i class="fa fa-check"></i><b>1.4</b> Radiographic Images</a></li>
<li class="chapter" data-level="1.5" data-path="magnetic-susceptability.html"><a href="magnetic-susceptability.html"><i class="fa fa-check"></i><b>1.5</b> Magnetic Susceptability</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing.html"><a href="importing.html"><i class="fa fa-check"></i><b>2</b> Importing Data</a>
<ul>
<li class="chapter" data-level="2.1" data-path="metadata-1.html"><a href="metadata-1.html"><i class="fa fa-check"></i><b>2.1</b> Metadata</a></li>
<li class="chapter" data-level="2.2" data-path="xrf-data-1.html"><a href="xrf-data-1.html"><i class="fa fa-check"></i><b>2.2</b> XRF Data</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="xrf-data-1.html"><a href="xrf-data-1.html#processed-data"><i class="fa fa-check"></i><b>2.2.1</b> Processed Data</a></li>
<li class="chapter" data-level="2.2.2" data-path="xrf-data-1.html"><a href="xrf-data-1.html#joining-xrf-data"><i class="fa fa-check"></i><b>2.2.2</b> Joining XRF Data</a></li>
<li class="chapter" data-level="2.2.3" data-path="xrf-data-1.html"><a href="xrf-data-1.html#raw-data"><i class="fa fa-check"></i><b>2.2.3</b> Raw Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="optical-images-1.html"><a href="optical-images-1.html"><i class="fa fa-check"></i><b>2.3</b> Optical Images</a></li>
<li class="chapter" data-level="2.4" data-path="radiographic-images-1.html"><a href="radiographic-images-1.html"><i class="fa fa-check"></i><b>2.4</b> Radiographic Images</a></li>
<li class="chapter" data-level="2.5" data-path="importing-everything.html"><a href="importing-everything.html"><i class="fa fa-check"></i><b>2.5</b> Importing Everything</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>3</b> Tidying Data</a>
<ul>
<li class="chapter" data-level="3.1" data-path="low-count-rates.html"><a href="low-count-rates.html"><i class="fa fa-check"></i><b>3.1</b> Low Count Rates</a></li>
<li class="chapter" data-level="3.2" data-path="model-errors-mse.html"><a href="model-errors-mse.html"><i class="fa fa-check"></i><b>3.2</b> Model Errors (MSE)</a></li>
<li class="chapter" data-level="3.3" data-path="surface-slope.html"><a href="surface-slope.html"><i class="fa fa-check"></i><b>3.3</b> Surface Slope</a></li>
<li class="chapter" data-level="3.4" data-path="high-argon.html"><a href="high-argon.html"><i class="fa fa-check"></i><b>3.4</b> High Argon</a></li>
<li class="chapter" data-level="3.5" data-path="combining-validity-flags.html"><a href="combining-validity-flags.html"><i class="fa fa-check"></i><b>3.5</b> Combining “Validity” Flags</a></li>
<li class="chapter" data-level="3.6" data-path="tube-current.html"><a href="tube-current.html"><i class="fa fa-check"></i><b>3.6</b> Tube current</a></li>
<li class="chapter" data-level="3.7" data-path="dead-time.html"><a href="dead-time.html"><i class="fa fa-check"></i><b>3.7</b> Dead Time</a></li>
<li class="chapter" data-level="3.8" data-path="correcting-for-water-content.html"><a href="correcting-for-water-content.html"><i class="fa fa-check"></i><b>3.8</b> Correcting for Water Content</a></li>
<li class="chapter" data-level="3.9" data-path="correcting-grain-size.html"><a href="correcting-grain-size.html"><i class="fa fa-check"></i><b>3.9</b> Correcting Grain Size</a></li>
<li class="chapter" data-level="3.10" data-path="uncertainties.html"><a href="uncertainties.html"><i class="fa fa-check"></i><b>3.10</b> Uncertainties</a></li>
<li class="chapter" data-level="3.11" data-path="noisy-data.html"><a href="noisy-data.html"><i class="fa fa-check"></i><b>3.11</b> Noisy Data</a></li>
<li class="chapter" data-level="3.12" data-path="reversing-data.html"><a href="reversing-data.html"><i class="fa fa-check"></i><b>3.12</b> Reversing Data</a></li>
<li class="chapter" data-level="3.13" data-path="visualising-raw-data.html"><a href="visualising-raw-data.html"><i class="fa fa-check"></i><b>3.13</b> Visualising Raw Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>4</b> Plotting</a>
<ul>
<li class="chapter" data-level="4.1" data-path="plotting-xrf-data.html"><a href="plotting-xrf-data.html"><i class="fa fa-check"></i><b>4.1</b> Plotting XRF Data</a></li>
<li class="chapter" data-level="4.2" data-path="plotting-images.html"><a href="plotting-images.html"><i class="fa fa-check"></i><b>4.2</b> Plotting Images</a></li>
<li class="chapter" data-level="4.3" data-path="combining-images-with-xrf-data.html"><a href="combining-images-with-xrf-data.html"><i class="fa fa-check"></i><b>4.3</b> Combining Images with XRF Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transforming-data.html"><a href="transforming-data.html"><i class="fa fa-check"></i><b>5</b> Transforming Data</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ratios-and-normalisation.html"><a href="ratios-and-normalisation.html"><i class="fa fa-check"></i><b>5.1</b> Ratios and Normalisation</a></li>
<li class="chapter" data-level="5.2" data-path="running-mean-and-other-window-functions.html"><a href="running-mean-and-other-window-functions.html"><i class="fa fa-check"></i><b>5.2</b> Running Mean and Other Window Functions</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-methods.html"><a href="multivariate-methods.html"><i class="fa fa-check"></i><b>6</b> Multivariate Methods</a>
<ul>
<li class="chapter" data-level="6.1" data-path="preparing-data-for-multivariate-data-analysis.html"><a href="preparing-data-for-multivariate-data-analysis.html"><i class="fa fa-check"></i><b>6.1</b> Preparing Data for Multivariate Data Analysis</a></li>
<li class="chapter" data-level="6.2" data-path="principal-component-analysis.html"><a href="principal-component-analysis.html"><i class="fa fa-check"></i><b>6.2</b> Principal Component Analysis</a></li>
<li class="chapter" data-level="6.3" data-path="using-ordr-for-pca.html"><a href="using-ordr-for-pca.html"><i class="fa fa-check"></i><b>6.3</b> Using <code>ordr</code> for PCA</a></li>
<li class="chapter" data-level="6.4" data-path="unconstrained-cluster-analysis.html"><a href="unconstrained-cluster-analysis.html"><i class="fa fa-check"></i><b>6.4</b> Unconstrained Cluster Analysis</a></li>
<li class="chapter" data-level="6.5" data-path="constrained-cluster-analysis.html"><a href="constrained-cluster-analysis.html"><i class="fa fa-check"></i><b>6.5</b> Constrained Cluster Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="calibrating-data.html"><a href="calibrating-data.html"><i class="fa fa-check"></i><b>7</b> Calibrating Data</a>
<ul>
<li class="chapter" data-level="7.1" data-path="suitable-methods.html"><a href="suitable-methods.html"><i class="fa fa-check"></i><b>7.1</b> Suitable Methods</a></li>
<li class="chapter" data-level="7.2" data-path="selecting-samples.html"><a href="selecting-samples.html"><i class="fa fa-check"></i><b>7.2</b> Selecting Samples</a></li>
<li class="chapter" data-level="7.3" data-path="preparing-data.html"><a href="preparing-data.html"><i class="fa fa-check"></i><b>7.3</b> Preparing Data</a></li>
<li class="chapter" data-level="7.4" data-path="linear-methods.html"><a href="linear-methods.html"><i class="fa fa-check"></i><b>7.4</b> Linear Methods</a></li>
<li class="chapter" data-level="7.5" data-path="log-ratio-methods.html"><a href="log-ratio-methods.html"><i class="fa fa-check"></i><b>7.5</b> Log-Ratio Methods</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exporting-data.html"><a href="exporting-data.html"><i class="fa fa-check"></i><b>8</b> Exporting Data</a>
<ul>
<li class="chapter" data-level="8.1" data-path="exporting-peak-area-data.html"><a href="exporting-peak-area-data.html"><i class="fa fa-check"></i><b>8.1</b> Exporting Peak Area Data</a></li>
<li class="chapter" data-level="8.2" data-path="creating-sumspectra.spe-files.html"><a href="creating-sumspectra.spe-files.html"><i class="fa fa-check"></i><b>8.2</b> Creating <code>sumspectra.spe</code> Files</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using Itrax Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="preparing-data" class="section level2 hasAnchor" number="7.3">
<h2><span class="header-section-number">7.3</span> Preparing Data<a href="preparing-data.html#preparing-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In order to perform empirical calibration it is necessary to have some quantitative data that relates directly to the Itrax XRF data. The quantitative data is unlikely to be at the same resolution as the Itrax XRF data. For example, it is typical to scan cores at between 0.2 and 1 mm, but typical to sub-sample for conventional XRF or ICP at between 5 - 10 mm. In addition, where Itrax scans are contiguous, sub-samples may not be, for example a 10 mm sub-sample might be taken every 80 mm. In this example we have sub-sampled and analysed the 60 samples defined in the previous section. Here they have been freeze-dried, lightly milled using agate stoneware, pressed into loose powder pellets and analysed with a Niton XL3t GOLDD+ ED-XRF using the “TestAllGeo” mode.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="preparing-data.html#cb80-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;calibration_samples/CD166_hhxrf.RData&quot;</span>)</span>
<span id="cb80-2"><a href="preparing-data.html#cb80-2" tabindex="-1"></a><span class="fu">glimpse</span>(hhxrf)</span></code></pre></div>
<pre><code>## Rows: 60
## Columns: 38
## $ top      &lt;dbl&gt; 330, 430, 440, 460, 670, 770, 800, 840, 930, 1020, 1090, 1110…
## $ bot      &lt;dbl&gt; 340, 440, 450, 470, 680, 780, 810, 850, 940, 1030, 1100, 1120…
## $ SampleID &lt;chr&gt; &quot;cd166-33&quot;, &quot;cd166-43&quot;, &quot;cd166-44&quot;, &quot;cd166-46&quot;, &quot;cd166-67&quot;, &quot;…
## $ Mg       (err) NA(NA), NA(NA), NA(NA), NA(NA), 30000(10000), NA(NA), NA(NA),…
## $ Al       (err) 14000(2000), 22000(2000), 25000(2000), 28000(3000), 19000(200…
## $ Si       (err) 45000(1000), 67000(1000), 75000(1000), 93000(1000), 56000(100…
## $ P        (err) NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), 300(2…
## $ S        (err) 890(80), 1200(80), 1110(80), 1600(90), 1020(80), 1160(80), 11…
## $ Cl       (err) 11100(100), 5210(90), 13100(100), 10700(100), 5870(90), 3180(…
## $ K        (err) 4700(200), 8200(200), 8900(200), 9000(200), 5700(200), 6100(2…
## $ Ca       (err) 2.48(2)e5, 2.14(1)e5, 1.97(1)e5, 1.90(1)e5, 2.32(1)e5, 2.24(1…
## $ Sc       (err) NA(NA), NA(NA), 260(90), NA(NA), NA(NA), NA(NA), 300(100), NA…
## $ Ti       (err) 900(100), 1360(90), 990(40), 1540(90), 1400(100), 2000(100), …
## $ V        (err) 60(20), 70(20), 60(20), 50(20), 70(20), 70(30), 70(20), 80(30…
## $ Cr       (err) 30(20), NA(NA), NA(NA), 30(20), 30(20), NA(NA), NA(NA), 50(20…
## $ Mn       (err) 250(40), 320(30), 280(30), 270(40), 240(30), 420(40), 380(30)…
## $ Fe       (err) 9200(200), 11900(100), 12400(100), 12800(200), 10400(100), 13…
## $ Co       (err) NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), 50(30…
## $ Ni       (err) NA(NA), NA(NA), NA(NA), 50(20), NA(NA), 30(20), 40(10), NA(NA…
## $ Cu       (err) 30(10), 28(8), 28(6), 21(9), 25(7), 37(8), 38(7), 33(8), 50(1…
## $ Zn       (err) 51(8), 67(6), 60(5), 33(6), 21(4), 25(5), 23(4), 21(5), 45(8)…
## $ As       (err) NA(NA), NA(NA), 16(5), NA(NA), NA(NA), 4(2), 6(3), NA(NA), 6(…
## $ Se       (err) NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), 2(1), NA(NA),…
## $ Rb       (err) 20(2), 28(2), 30(1), 29(2), 18(1), 19(1), 17(1), 17(1), 14(2)…
## $ Sr       (err) 950(10), 824(7), 720(5), 646(7), 862(6), 854(7), 794(5), 845(…
## $ Zr       (err) 42(4), 48(3), 43(2), 53(3), 48(2), 54(3), 52(2), 58(3), 129(4…
## $ Nb       (err) 6(1), 5(1), 5.2(8), 4(1), 5.4(9), 8(1), 6.9(9), 9(1), 20(10),…
## $ Mo       (err) 6(2), 3(2), 3(1), NA(NA), 4(1), 3(2), 3(1), 3(1), 5(2), 3(2),…
## $ Ag       (err) 5(3), 5(3), NA(NA), NA(NA), NA(NA), 6(3), NA(NA), NA(NA), NA(…
## $ Cd       (err) 10(6), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA)…
## $ Sn       (err) 13(7), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA)…
## $ Ba       (err) 170(30), 130(30), 150(30), 220(30), 150(30), 140(30), 180(30)…
## $ W        (err) NA(NA), NA(NA), NA(NA), NA(NA), 20(10), 30(20), NA(NA), NA(NA…
## $ Au       (err) NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), 4(3),…
## $ Hg       (err) NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA…
## $ Pb       (err) 6(3), 13(3), 227(6), 10(3), 6(2), 10(2), 47(3), 10(2), 8(3), …
## $ Th       (err) 5(2), 4(2), 10(4), 4(2), 4(1), 13(5), 12(4), 13(5), NA(NA), 4…
## $ U        (err) NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA), NA(NA…</code></pre>
<p>The function <code>itraxR::itrax_reduce()</code> can be used to reduce the Itrax data to match the resolution of some other data. The example below uses the same positions of the conventional XRF analyses of the data to summarise it. And here is the use of <code>itrax_reduce()</code> to reduce our Itrax XRF data (<code>CD166_19_xrf</code>), using the shape of the conventional XRF data (in <code>xrf</code>). Note the requirement to remove text based columns (in this case <code>file</code> and <code>label</code>) from the data before this step is performed - if the reducing function cannot handle a data type (e.g. passing characters to <code>mean()</code>), errors will occur. If we wanted to add the standard deviation alongside the mean for each chunk, this can be done my modifying the default reducing function (<code>mean()</code>) to <code>sd()</code>, for example:</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="preparing-data.html#cb82-1" tabindex="-1"></a>xrf <span class="ot">&lt;-</span> CD166_19_xrf <span class="sc">%&gt;%</span></span>
<span id="cb82-2"><a href="preparing-data.html#cb82-2" tabindex="-1"></a>  <span class="fu">filter</span>(qc <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb82-3"><a href="preparing-data.html#cb82-3" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">c</span>(label, filename, uid)) <span class="sc">%&gt;%</span></span>
<span id="cb82-4"><a href="preparing-data.html#cb82-4" tabindex="-1"></a>  <span class="fu">itrax_reduce</span>(<span class="at">names =</span> hhxrf<span class="sc">$</span>SampleID,</span>
<span id="cb82-5"><a href="preparing-data.html#cb82-5" tabindex="-1"></a>               <span class="at">breaks_lower =</span> hhxrf<span class="sc">$</span>top,</span>
<span id="cb82-6"><a href="preparing-data.html#cb82-6" tabindex="-1"></a>               <span class="at">breaks_upper =</span> hhxrf<span class="sc">$</span>bot) <span class="sc">%&gt;%</span></span>
<span id="cb82-7"><a href="preparing-data.html#cb82-7" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">SampleID =</span> resample_names) <span class="sc">%&gt;%</span></span>
<span id="cb82-8"><a href="preparing-data.html#cb82-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">top =</span> hhxrf<span class="sc">$</span>top, </span>
<span id="cb82-9"><a href="preparing-data.html#cb82-9" tabindex="-1"></a>         <span class="at">bot =</span> hhxrf<span class="sc">$</span>bot)</span>
<span id="cb82-10"><a href="preparing-data.html#cb82-10" tabindex="-1"></a></span>
<span id="cb82-11"><a href="preparing-data.html#cb82-11" tabindex="-1"></a><span class="fu">glimpse</span>(xrf)</span></code></pre></div>
<pre><code>## Rows: 60
## Columns: 58
## $ SampleID         &lt;chr&gt; &quot;cd166-33&quot;, &quot;cd166-43&quot;, &quot;cd166-44&quot;, &quot;cd166-46&quot;, &quot;cd16…
## $ depth            &lt;dbl&gt; 334.5, 434.5, 444.5, 464.5, 674.5, 774.5, 804.5, 844.…
## $ MSE              &lt;dbl&gt; 1.707, 1.585, 1.562, 1.499, 1.644, 1.581, 1.669, 1.65…
## $ cps              &lt;dbl&gt; 46735.9, 38494.0, 36829.5, 34929.5, 44762.0, 45024.2,…
## $ validity         &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ Al               &lt;dbl&gt; 79.5, 71.5, 78.1, 57.0, 77.0, 87.5, 71.1, 75.0, 71.0,…
## $ Si               &lt;dbl&gt; 347.4, 929.3, 1338.6, 1043.9, 394.1, 424.5, 375.0, 41…
## $ P                &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ S                &lt;dbl&gt; 54.5, 7.6, 6.0, 10.6, 89.2, 28.3, 17.8, 20.1, 12.1, 2…
## $ Cl               &lt;dbl&gt; 1839.4, 755.2, 492.3, 677.4, 1781.5, 1499.4, 1565.9, …
## $ Ar               &lt;dbl&gt; 651.4, 543.7, 446.4, 398.8, 530.5, 503.7, 525.3, 552.…
## $ K                &lt;dbl&gt; 2539.8, 3059.0, 3143.8, 3182.9, 2910.6, 2885.7, 2597.…
## $ Ca               &lt;dbl&gt; 234113.7, 157804.5, 97585.4, 115428.4, 202283.5, 2034…
## $ Sc               &lt;dbl&gt; 0.0, 0.0, 0.0, 0.0, 10.1, 0.0, 0.0, 0.0, 0.0, 4.9, 9.…
## $ Ti               &lt;dbl&gt; 1723.8, 1936.0, 4692.8, 1964.6, 2398.6, 2549.2, 2194.…
## $ V                &lt;dbl&gt; 15.5, 59.0, 116.6, 77.9, 26.2, 56.6, 39.0, 52.1, 82.2…
## $ Cr               &lt;dbl&gt; 309.6, 260.2, 329.8, 278.6, 343.1, 314.9, 281.7, 347.…
## $ Mn               &lt;dbl&gt; 743.8, 580.3, 794.1, 796.1, 597.4, 910.3, 738.9, 723.…
## $ Fe               &lt;dbl&gt; 32624.9, 43792.7, 74938.8, 44888.9, 40525.2, 45688.0,…
## $ Ni               &lt;dbl&gt; 98.3, 65.7, 77.2, 92.3, 86.3, 108.4, 123.6, 114.2, 17…
## $ Cu               &lt;dbl&gt; 191.6, 90.3, 94.3, 80.6, 171.4, 202.8, 172.6, 185.2, …
## $ Zn               &lt;dbl&gt; 145.4, 163.5, 171.5, 177.8, 161.8, 179.2, 142.6, 176.…
## $ Ga               &lt;dbl&gt; 9.5, 80.8, 110.2, 72.1, 19.6, 23.1, 10.0, 27.2, 13.9,…
## $ Ge               &lt;dbl&gt; 73.6, 103.1, 107.7, 104.2, 95.5, 105.4, 68.3, 115.3, …
## $ Br               &lt;dbl&gt; 494.0, 287.1, 204.8, 260.3, 483.4, 431.7, 422.9, 409.…
## $ Rb               &lt;dbl&gt; 196.6, 295.8, 404.3, 375.9, 201.0, 221.6, 182.8, 188.…
## $ Sr               &lt;dbl&gt; 11406.2, 6618.7, 4505.5, 5548.2, 10746.5, 10305.0, 10…
## $ Y                &lt;dbl&gt; 109.9, 97.8, 108.0, 52.5, 156.0, 126.7, 159.1, 114.1,…
## $ Zr               &lt;dbl&gt; 208.0, 413.4, 2082.7, 456.9, 257.6, 320.7, 294.2, 301…
## $ Pd               &lt;dbl&gt; 79.9, 43.0, 25.8, 31.4, 72.0, 63.6, 64.2, 61.6, 41.7,…
## $ Cd               &lt;dbl&gt; 111.5, 88.6, 44.8, 56.3, 83.5, 88.5, 108.0, 109.8, 72…
## $ I                &lt;dbl&gt; 57.1, 54.8, 27.5, 28.9, 70.6, 61.9, 69.2, 74.6, 57.5,…
## $ Cs               &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…
## $ Ba               &lt;dbl&gt; 29.7, 44.3, 111.6, 72.4, 31.7, 53.1, 10.6, 28.2, 18.9…
## $ Nd               &lt;dbl&gt; 34.3, 20.9, 46.1, 32.5, 27.5, 31.2, 28.2, 29.6, 37.0,…
## $ Sm               &lt;dbl&gt; 6.9, 47.8, 82.8, 50.0, 15.6, 18.5, 15.8, 16.7, 28.7, …
## $ Yb               &lt;dbl&gt; 345.3, 276.6, 205.2, 178.5, 285.1, 264.9, 262.9, 277.…
## $ Ta               &lt;dbl&gt; 727.9, 659.0, 603.8, 630.3, 746.6, 688.6, 706.4, 674.…
## $ W                &lt;dbl&gt; 2288.2, 2044.0, 2001.0, 2056.4, 2153.3, 2090.1, 2129.…
## $ Pb               &lt;dbl&gt; 63.7, 64.7, 109.2, 66.6, 55.0, 87.7, 40.4, 217.0, 49.…
## $ Bi               &lt;dbl&gt; 162.0, 123.9, 136.1, 124.1, 148.2, 139.9, 126.7, 147.…
## $ `Mo inc`         &lt;dbl&gt; 26754.9, 23616.2, 21588.2, 23656.8, 26309.5, 25681.1,…
## $ `Mo coh`         &lt;dbl&gt; 10207.9, 9466.9, 8911.0, 9174.5, 9985.4, 9881.3, 1007…
## $ position         &lt;dbl&gt; 366.04, 466.04, 476.04, 496.04, 706.04, 806.04, 836.0…
## $ `sample surface` &lt;dbl&gt; 6.498, 6.000, 6.005, 6.080, 6.466, 6.484, 6.476, 6.51…
## $ `E-gain`         &lt;dbl&gt; 0.010267, 0.010267, 0.010267, 0.010267, 0.010267, 0.0…
## $ `E-offset`       &lt;dbl&gt; -0.009931, -0.009931, -0.009931, -0.009931, -0.009931…
## $ `F-slope`        &lt;dbl&gt; 0.0099, 0.0099, 0.0099, 0.0099, 0.0099, 0.0099, 0.009…
## $ `F-offset`       &lt;dbl&gt; 0.077115, 0.077115, 0.077115, 0.077115, 0.077115, 0.0…
## $ `Fe a*2`         &lt;dbl&gt; 158.6, 74.1, 132.1, 167.6, 158.4, 118.7, 125.7, 105.0…
## $ `Fe a+b`         &lt;dbl&gt; 82.2, 139.4, 111.5, 146.1, 136.0, 146.1, 133.9, 106.2…
## $ S1               &lt;dbl&gt; 306.6, 311.3, 475.1, 303.5, 318.9, 370.9, 274.8, 380.…
## $ S2               &lt;dbl&gt; 219.8, 199.8, 299.0, 209.5, 244.8, 263.5, 231.1, 249.…
## $ S3               &lt;dbl&gt; 252.7, 298.4, 430.0, 337.4, 261.1, 340.6, 312.0, 380.…
## $ Dt               &lt;dbl&gt; 0.1021, 0.0990, 0.0979, 0.1017, 0.1022, 0.1008, 0.101…
## $ qc               &lt;dbl&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
## $ top              &lt;dbl&gt; 330, 430, 440, 460, 670, 770, 800, 840, 930, 1020, 10…
## $ bot              &lt;dbl&gt; 340, 440, 450, 470, 680, 780, 810, 850, 940, 1030, 11…</code></pre>
<p>It is worth reading <code>?itraxR::itrax_reduce()</code> as the behavior can and should be modified depending on your exact use case. For example, in th situation above where none of the samples are contiguous it might be wise to modify the parameters of <code>itraxR::itrax_reduce()</code> to include <code>edges = c("&gt;=", "&lt;=")</code> so that the “edges” of the sub-samples are captured. This might not be the case for contiguous samples in order to avoid “double-counting”.</p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="selecting-samples.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="linear-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["itraxBook.pdf", "itraxBook.epub"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

</body>

</html>
