<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.2 Plotting Images | Using Itrax Data in R</title>
  <meta name="description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="4.2 Plotting Images | Using Itrax Data in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.2 Plotting Images | Using Itrax Data in R" />
  
  <meta name="twitter:description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  

<meta name="author" content="Thomas Bishop" />


<meta name="date" content="2021-01-25" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="plotting-xrf-data.html"/>
<link rel="next" href="combining-images-with-xrf-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Using Itrax Data in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="the-itraxr-package.html"><a href="the-itraxr-package.html"><i class="fa fa-check"></i><b>0.1</b> The itraxR Package</a></li>
<li class="chapter" data-level="0.2" data-path="prerequisites.html"><a href="prerequisites.html"><i class="fa fa-check"></i><b>0.2</b> Prerequisites</a></li>
<li class="chapter" data-level="0.3" data-path="example-data.html"><a href="example-data.html"><i class="fa fa-check"></i><b>0.3</b> Example Data</a></li>
<li class="chapter" data-level="0.4" data-path="utility-data.html"><a href="utility-data.html"><i class="fa fa-check"></i><b>0.4</b> Utility Data</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Data Structure</a><ul>
<li class="chapter" data-level="1.1" data-path="metadata.html"><a href="metadata.html"><i class="fa fa-check"></i><b>1.1</b> Metadata</a></li>
<li class="chapter" data-level="1.2" data-path="xrf-data.html"><a href="xrf-data.html"><i class="fa fa-check"></i><b>1.2</b> XRF Data</a></li>
<li class="chapter" data-level="1.3" data-path="optical-images.html"><a href="optical-images.html"><i class="fa fa-check"></i><b>1.3</b> Optical Images</a></li>
<li class="chapter" data-level="1.4" data-path="radiographic-images.html"><a href="radiographic-images.html"><i class="fa fa-check"></i><b>1.4</b> Radiographic Images</a></li>
<li class="chapter" data-level="1.5" data-path="magnetic-susceptability.html"><a href="magnetic-susceptability.html"><i class="fa fa-check"></i><b>1.5</b> Magnetic Susceptability</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing.html"><a href="importing.html"><i class="fa fa-check"></i><b>2</b> Importing Data</a><ul>
<li class="chapter" data-level="2.1" data-path="metadata-1.html"><a href="metadata-1.html"><i class="fa fa-check"></i><b>2.1</b> Metadata</a></li>
<li class="chapter" data-level="2.2" data-path="xrf-data-1.html"><a href="xrf-data-1.html"><i class="fa fa-check"></i><b>2.2</b> XRF Data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="xrf-data-1.html"><a href="xrf-data-1.html#processed-data"><i class="fa fa-check"></i><b>2.2.1</b> Processed Data</a></li>
<li class="chapter" data-level="2.2.2" data-path="xrf-data-1.html"><a href="xrf-data-1.html#joining-xrf-data"><i class="fa fa-check"></i><b>2.2.2</b> Joining XRF Data</a></li>
<li class="chapter" data-level="2.2.3" data-path="xrf-data-1.html"><a href="xrf-data-1.html#raw-data"><i class="fa fa-check"></i><b>2.2.3</b> Raw Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="optical-images-1.html"><a href="optical-images-1.html"><i class="fa fa-check"></i><b>2.3</b> Optical Images</a></li>
<li class="chapter" data-level="2.4" data-path="radiographic-images-1.html"><a href="radiographic-images-1.html"><i class="fa fa-check"></i><b>2.4</b> Radiographic Images</a></li>
<li class="chapter" data-level="2.5" data-path="importing-everything.html"><a href="importing-everything.html"><i class="fa fa-check"></i><b>2.5</b> Importing Everything</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>3</b> Tidying Data</a><ul>
<li class="chapter" data-level="3.1" data-path="low-count-rates.html"><a href="low-count-rates.html"><i class="fa fa-check"></i><b>3.1</b> Low Count Rates</a></li>
<li class="chapter" data-level="3.2" data-path="surface-slope.html"><a href="surface-slope.html"><i class="fa fa-check"></i><b>3.2</b> Surface Slope</a></li>
<li class="chapter" data-level="3.3" data-path="combining-validity-flags.html"><a href="combining-validity-flags.html"><i class="fa fa-check"></i><b>3.3</b> Combining “Validity” Flags</a></li>
<li class="chapter" data-level="3.4" data-path="tube-current.html"><a href="tube-current.html"><i class="fa fa-check"></i><b>3.4</b> Tube current</a></li>
<li class="chapter" data-level="3.5" data-path="dead-time.html"><a href="dead-time.html"><i class="fa fa-check"></i><b>3.5</b> Dead Time</a></li>
<li class="chapter" data-level="3.6" data-path="correcting-for-water-content.html"><a href="correcting-for-water-content.html"><i class="fa fa-check"></i><b>3.6</b> Correcting for Water Content</a></li>
<li class="chapter" data-level="3.7" data-path="correcting-grain-size.html"><a href="correcting-grain-size.html"><i class="fa fa-check"></i><b>3.7</b> Correcting Grain Size</a></li>
<li class="chapter" data-level="3.8" data-path="uncertainties.html"><a href="uncertainties.html"><i class="fa fa-check"></i><b>3.8</b> Uncertainties</a></li>
<li class="chapter" data-level="3.9" data-path="high-signal-to-noise-ratios.html"><a href="high-signal-to-noise-ratios.html"><i class="fa fa-check"></i><b>3.9</b> High Signal-to-noise Ratios</a></li>
<li class="chapter" data-level="3.10" data-path="reversing-data.html"><a href="reversing-data.html"><i class="fa fa-check"></i><b>3.10</b> Reversing Data</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>4</b> Plotting</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting-xrf-data.html"><a href="plotting-xrf-data.html"><i class="fa fa-check"></i><b>4.1</b> Plotting XRF Data</a></li>
<li class="chapter" data-level="4.2" data-path="plotting-images.html"><a href="plotting-images.html"><i class="fa fa-check"></i><b>4.2</b> Plotting Images</a></li>
<li class="chapter" data-level="4.3" data-path="combining-images-with-xrf-data.html"><a href="combining-images-with-xrf-data.html"><i class="fa fa-check"></i><b>4.3</b> Combining Images with XRF Data</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transforming-data.html"><a href="transforming-data.html"><i class="fa fa-check"></i><b>5</b> Transforming Data</a><ul>
<li class="chapter" data-level="5.1" data-path="ratios-and-normalisation.html"><a href="ratios-and-normalisation.html"><i class="fa fa-check"></i><b>5.1</b> Ratios and Normalisation</a></li>
<li class="chapter" data-level="5.2" data-path="preparing-data-for-multivariate-data-analysis.html"><a href="preparing-data-for-multivariate-data-analysis.html"><i class="fa fa-check"></i><b>5.2</b> Preparing Data for Multivariate Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-methods.html"><a href="multivariate-methods.html"><i class="fa fa-check"></i><b>6</b> Multivariate Methods</a><ul>
<li class="chapter" data-level="6.1" data-path="correlation-coefficients.html"><a href="correlation-coefficients.html"><i class="fa fa-check"></i><b>6.1</b> Correlation Coefficients</a></li>
<li class="chapter" data-level="6.2" data-path="unconstrained-cluster-analysis.html"><a href="unconstrained-cluster-analysis.html"><i class="fa fa-check"></i><b>6.2</b> Unconstrained Cluster Analysis</a></li>
<li class="chapter" data-level="6.3" data-path="constrained-cluster-analaysis.html"><a href="constrained-cluster-analaysis.html"><i class="fa fa-check"></i><b>6.3</b> Constrained Cluster Analaysis</a></li>
<li class="chapter" data-level="6.4" data-path="principle-components-analysis.html"><a href="principle-components-analysis.html"><i class="fa fa-check"></i><b>6.4</b> Principle Components Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="calibrating-data.html"><a href="calibrating-data.html"><i class="fa fa-check"></i><b>7</b> Calibrating Data</a><ul>
<li class="chapter" data-level="7.1" data-path="suitable-methods.html"><a href="suitable-methods.html"><i class="fa fa-check"></i><b>7.1</b> Suitable Methods</a></li>
<li class="chapter" data-level="7.2" data-path="preparing-data.html"><a href="preparing-data.html"><i class="fa fa-check"></i><b>7.2</b> Preparing Data</a></li>
<li class="chapter" data-level="7.3" data-path="linear-methods.html"><a href="linear-methods.html"><i class="fa fa-check"></i><b>7.3</b> Linear Methods</a></li>
<li class="chapter" data-level="7.4" data-path="log-ratio-methods.html"><a href="log-ratio-methods.html"><i class="fa fa-check"></i><b>7.4</b> Log-Ratio Methods</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="exporting-data.html"><a href="exporting-data.html"><i class="fa fa-check"></i><b>8</b> Exporting Data</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using Itrax Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="plotting-images" class="section level2">
<h2><span class="header-section-number">4.2</span> Plotting Images</h2>
<p>The package <code>itraxR</code> provides functions for importing and creating basic plots of both the photographic and radiographic images. For the optical images, it is almost always necessary to trim the image to the extent of the actual scan, or extraneous image is included (e.g. the calibration card in the example shown below). The function <code>itraxR::itrax_image()</code> allows the extent of the scan to be defined, or extracted from the metadata. In the example below, <code>trim = FALSE</code> forces the whole image to be shown. When dealing with high aspect ratio images like these, it is often useful to use <code>svgPanZoom::svgPanZoom()</code> instead of <code>print()</code> to view the output.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="plotting-images.html#cb39-1"></a>myImage &lt;-<span class="st"> </span><span class="kw">itrax_image</span>(<span class="dt">file =</span> <span class="st">&quot;CD166_19_S1/CD166_19_S1/optical.tif&quot;</span>,</span>
<span id="cb39-2"><a href="plotting-images.html#cb39-2"></a>                       <span class="dt">meta =</span> <span class="st">&quot;CD166_19_S1/CD166_19_S1/document.txt&quot;</span>,</span>
<span id="cb39-3"><a href="plotting-images.html#cb39-3"></a>                       <span class="dt">trim =</span> <span class="ot">FALSE</span>,</span>
<span id="cb39-4"><a href="plotting-images.html#cb39-4"></a>                       <span class="dt">plot =</span> <span class="ot">TRUE</span></span>
<span id="cb39-5"><a href="plotting-images.html#cb39-5"></a>                       )</span></code></pre></div>
<p><img src="itraxBook_files/figure-html/plot_image-1.png" width="672" /></p>
<p>For radiographic images the function <code>itraxR::itrax_radiograph()</code> can be used using an identical syntax as <code>itraxR::itrax_image()</code>. Often the contrast needs to be adjusted, so a contrast-adjusted radiograph is supplied in the example data (<code>radiograph0.tif</code>).</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="plotting-images.html#cb40-1"></a>myRadio &lt;-<span class="st"> </span><span class="kw">itrax_radiograph</span>(<span class="dt">file =</span> <span class="st">&quot;CD166_19_S1/CD166_19_S1_RAD/radiograph0.tif&quot;</span>,</span>
<span id="cb40-2"><a href="plotting-images.html#cb40-2"></a>                            <span class="dt">meta =</span> <span class="st">&quot;CD166_19_S1/CD166_19_S1_RAD/document.txt&quot;</span>,</span>
<span id="cb40-3"><a href="plotting-images.html#cb40-3"></a>                            <span class="dt">plot =</span> <span class="ot">TRUE</span></span>
<span id="cb40-4"><a href="plotting-images.html#cb40-4"></a>                            )</span></code></pre></div>
<p><img src="itraxBook_files/figure-html/itrax_image-1.png" width="672" /></p>
<p>The simple plots generated as a side effect of these functions are sometimes sufficient for simple plots, but for more complex diagrams you will need to generate them from scratch. For example, it is often desirable to overplot the radiograph on the optical image. The code below does this. Note the calculations made for the <code>xmin =</code> and <code>ymin =</code> parameters for <code>annotation_custom()</code> when adding the radiograph <code>rasterGrob()</code>; these correctly position the radiograph along the centre of the image.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="plotting-images.html#cb41-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb41-2"><a href="plotting-images.html#cb41-2"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="kw">rev</span>(<span class="kw">range</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(myImage<span class="op">$</span>image))))) <span class="op">+</span></span>
<span id="cb41-3"><a href="plotting-images.html#cb41-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">round</span>(<span class="kw">range</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(myImage<span class="op">$</span>image))), <span class="dv">0</span>),</span>
<span id="cb41-4"><a href="plotting-images.html#cb41-4"></a>                     <span class="dt">limits =</span> <span class="kw">range</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(myImage<span class="op">$</span>image)))) <span class="op">+</span></span>
<span id="cb41-5"><a href="plotting-images.html#cb41-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Position [mm]&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;[mm]&quot;</span>) <span class="op">+</span></span>
<span id="cb41-6"><a href="plotting-images.html#cb41-6"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(myImage<span class="op">$</span>image,</span>
<span id="cb41-7"><a href="plotting-images.html#cb41-7"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb41-8"><a href="plotting-images.html#cb41-8"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb41-9"><a href="plotting-images.html#cb41-9"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(myImage<span class="op">$</span>image)))<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb41-10"><a href="plotting-images.html#cb41-10"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(myImage<span class="op">$</span>image)))<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb41-11"><a href="plotting-images.html#cb41-11"></a>                    <span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(myImage<span class="op">$</span>image))),</span>
<span id="cb41-12"><a href="plotting-images.html#cb41-12"></a>                    <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(myImage<span class="op">$</span>image)))</span>
<span id="cb41-13"><a href="plotting-images.html#cb41-13"></a>  ) <span class="op">+</span></span>
<span id="cb41-14"><a href="plotting-images.html#cb41-14"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(myRadio<span class="op">$</span>image,</span>
<span id="cb41-15"><a href="plotting-images.html#cb41-15"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb41-16"><a href="plotting-images.html#cb41-16"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb41-17"><a href="plotting-images.html#cb41-17"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(myRadio<span class="op">$</span>image)))<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb41-18"><a href="plotting-images.html#cb41-18"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(myRadio<span class="op">$</span>image)))<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb41-19"><a href="plotting-images.html#cb41-19"></a>                    <span class="dt">xmin =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(myImage<span class="op">$</span>image))) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(myRadio<span class="op">$</span>image))),</span>
<span id="cb41-20"><a href="plotting-images.html#cb41-20"></a>                    <span class="dt">xmax =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(myImage<span class="op">$</span>image))) <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(myRadio<span class="op">$</span>image)))</span>
<span id="cb41-21"><a href="plotting-images.html#cb41-21"></a>  ) <span class="op">+</span></span>
<span id="cb41-22"><a href="plotting-images.html#cb41-22"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="itraxBook_files/figure-html/overplot-1.png" width="672" /></p>
<p>It is often desirable to combine a sequence of cores. This is trivial for cores like <code>CD166_19</code> where there are no overlapping sections. However, note that the coring depth information is different from the <code>position</code> that these images are referenced to. The coring depth is not contained in any of the Itrax metadata, and should be recorded elsewhere, whereas <code>position</code> refers to the coordinates on the Itrax core holder. In the code below the depth information is extracted from the combined XRF data created in a previous chapter (for example using <code>max(CD166_19[which(CD166_19$label == "S2"),]$depth)</code> to get the maximum depth of the middle section. The radiographs can be added in the same fashion as the previous example.</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="plotting-images.html#cb42-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb42-2"><a href="plotting-images.html#cb42-2"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="kw">rev</span>(<span class="kw">range</span>(CD166_<span class="dv">19</span>_xrf<span class="op">$</span>depth))) <span class="op">+</span></span>
<span id="cb42-3"><a href="plotting-images.html#cb42-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">round</span>(<span class="kw">range</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image))), <span class="dv">0</span>),</span>
<span id="cb42-4"><a href="plotting-images.html#cb42-4"></a>                     <span class="dt">limits =</span> <span class="kw">range</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image)))) <span class="op">+</span></span>
<span id="cb42-5"><a href="plotting-images.html#cb42-5"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb42-6"><a href="plotting-images.html#cb42-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Depth [mm]&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;[mm]&quot;</span>) <span class="op">+</span></span>
<span id="cb42-7"><a href="plotting-images.html#cb42-7"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image,</span>
<span id="cb42-8"><a href="plotting-images.html#cb42-8"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb42-9"><a href="plotting-images.html#cb42-9"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb42-10"><a href="plotting-images.html#cb42-10"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb42-11"><a href="plotting-images.html#cb42-11"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb42-12"><a href="plotting-images.html#cb42-12"></a>                    <span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image))),</span>
<span id="cb42-13"><a href="plotting-images.html#cb42-13"></a>                    <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image)))</span>
<span id="cb42-14"><a href="plotting-images.html#cb42-14"></a>  ) <span class="op">+</span></span>
<span id="cb42-15"><a href="plotting-images.html#cb42-15"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image,</span>
<span id="cb42-16"><a href="plotting-images.html#cb42-16"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb42-17"><a href="plotting-images.html#cb42-17"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb42-18"><a href="plotting-images.html#cb42-18"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb42-19"><a href="plotting-images.html#cb42-19"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb42-20"><a href="plotting-images.html#cb42-20"></a>                    <span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image))),</span>
<span id="cb42-21"><a href="plotting-images.html#cb42-21"></a>                    <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image)))</span>
<span id="cb42-22"><a href="plotting-images.html#cb42-22"></a>  ) <span class="op">+</span></span>
<span id="cb42-23"><a href="plotting-images.html#cb42-23"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>image<span class="op">$</span>image,</span>
<span id="cb42-24"><a href="plotting-images.html#cb42-24"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb42-25"><a href="plotting-images.html#cb42-25"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb42-26"><a href="plotting-images.html#cb42-26"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb42-27"><a href="plotting-images.html#cb42-27"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb42-28"><a href="plotting-images.html#cb42-28"></a>                    <span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>image<span class="op">$</span>image))),</span>
<span id="cb42-29"><a href="plotting-images.html#cb42-29"></a>                    <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>image<span class="op">$</span>image)))</span>
<span id="cb42-30"><a href="plotting-images.html#cb42-30"></a>  )</span></code></pre></div>
<p><img src="itraxBook_files/figure-html/overplot_sequence-1.png" width="672" /></p>
<p>Where there are overlaps it is often desirable to plot the cores adjacent to one another. It is simply a case of adjusting the <code>xmin =</code> and <code>xmax =</code> parameters in the <code>annotation_custom()</code> function for every other section. In this context the x-axis labels become largely meaningless and can be omitted.</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="plotting-images.html#cb43-1"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb43-2"><a href="plotting-images.html#cb43-2"></a><span class="st">  </span><span class="kw">ylim</span>(<span class="kw">rev</span>(<span class="kw">range</span>(CD166_<span class="dv">19</span>_xrf<span class="op">$</span>depth))) <span class="op">+</span></span>
<span id="cb43-3"><a href="plotting-images.html#cb43-3"></a><span class="st">  </span><span class="kw">scale_x_continuous</span>(<span class="dt">breaks =</span> <span class="kw">round</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image)))<span class="op">*</span><span class="dv">2</span>)),</span>
<span id="cb43-4"><a href="plotting-images.html#cb43-4"></a>                     <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image)))<span class="op">*</span><span class="dv">2</span>)) <span class="op">+</span></span>
<span id="cb43-5"><a href="plotting-images.html#cb43-5"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb43-6"><a href="plotting-images.html#cb43-6"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;Depth [mm]&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;[mm]&quot;</span>) <span class="op">+</span></span>
<span id="cb43-7"><a href="plotting-images.html#cb43-7"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image,</span>
<span id="cb43-8"><a href="plotting-images.html#cb43-8"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb43-9"><a href="plotting-images.html#cb43-9"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb43-10"><a href="plotting-images.html#cb43-10"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb43-11"><a href="plotting-images.html#cb43-11"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb43-12"><a href="plotting-images.html#cb43-12"></a>                    <span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image))),</span>
<span id="cb43-13"><a href="plotting-images.html#cb43-13"></a>                    <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image)))</span>
<span id="cb43-14"><a href="plotting-images.html#cb43-14"></a>  ) <span class="op">+</span></span>
<span id="cb43-15"><a href="plotting-images.html#cb43-15"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image,</span>
<span id="cb43-16"><a href="plotting-images.html#cb43-16"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb43-17"><a href="plotting-images.html#cb43-17"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb43-18"><a href="plotting-images.html#cb43-18"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb43-19"><a href="plotting-images.html#cb43-19"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb43-20"><a href="plotting-images.html#cb43-20"></a>                    <span class="dt">xmin =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image))),</span>
<span id="cb43-21"><a href="plotting-images.html#cb43-21"></a>                    <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image)))<span class="op">*</span><span class="dv">2</span></span>
<span id="cb43-22"><a href="plotting-images.html#cb43-22"></a>  ) <span class="op">+</span></span>
<span id="cb43-23"><a href="plotting-images.html#cb43-23"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>image<span class="op">$</span>image,</span>
<span id="cb43-24"><a href="plotting-images.html#cb43-24"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb43-25"><a href="plotting-images.html#cb43-25"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb43-26"><a href="plotting-images.html#cb43-26"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb43-27"><a href="plotting-images.html#cb43-27"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb43-28"><a href="plotting-images.html#cb43-28"></a>                    <span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>image<span class="op">$</span>image))),</span>
<span id="cb43-29"><a href="plotting-images.html#cb43-29"></a>                    <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>image<span class="op">$</span>image)))</span>
<span id="cb43-30"><a href="plotting-images.html#cb43-30"></a>  )</span></code></pre></div>
<p><img src="itraxBook_files/figure-html/sideplot_sequence-1.png" width="672" /></p>
<p>Note that omitting the line <code>coord_fixed(ratio = 1)</code> allows the aspect ratio of the plot to be reshaped. Although usually it is desirable to keep the plot in the correct shape, sometimes for very long sequences the images end up so narrow as to be quite useless, so the x-axis can be stretched to accentuate the features in it. The example below simply omits the <code>coord_fixed()</code> line from the previous example.</p>
<p><img src="itraxBook_files/figure-html/sideplot_sequence_aspectratio-1.png" width="672" /></p>
<p>Recall that <code>ggplot</code> objects can be saved and recalled rather than immediately printed. Let us take the plot generated in a previous example, but assign it using <code>imagePlot &lt;- ggplot() + ...</code>.</p>
<p>The radiographs can be added afterwards without starting from scratch. We can also modify plot parameters, for example, the x-axis labels can be removed.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="plotting-images.html#cb44-1"></a>imagePlot &lt;-<span class="st"> </span>imagePlot <span class="op">+</span></span>
<span id="cb44-2"><a href="plotting-images.html#cb44-2"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>radiograph<span class="op">$</span>image,</span>
<span id="cb44-3"><a href="plotting-images.html#cb44-3"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb44-4"><a href="plotting-images.html#cb44-4"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb44-5"><a href="plotting-images.html#cb44-5"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb44-6"><a href="plotting-images.html#cb44-6"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb44-7"><a href="plotting-images.html#cb44-7"></a>                    <span class="dt">xmin =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image))) <span class="op">-</span></span>
<span id="cb44-8"><a href="plotting-images.html#cb44-8"></a><span class="st">                      </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>radiograph<span class="op">$</span>image))),</span>
<span id="cb44-9"><a href="plotting-images.html#cb44-9"></a>                    <span class="dt">xmax =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image))) <span class="op">+</span></span>
<span id="cb44-10"><a href="plotting-images.html#cb44-10"></a><span class="st">                      </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>radiograph<span class="op">$</span>image)))</span>
<span id="cb44-11"><a href="plotting-images.html#cb44-11"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-12"><a href="plotting-images.html#cb44-12"></a><span class="st">    </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>radiograph<span class="op">$</span>image,</span>
<span id="cb44-13"><a href="plotting-images.html#cb44-13"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb44-14"><a href="plotting-images.html#cb44-14"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb44-15"><a href="plotting-images.html#cb44-15"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb44-16"><a href="plotting-images.html#cb44-16"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb44-17"><a href="plotting-images.html#cb44-17"></a>                    <span class="dt">xmin =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image))) <span class="op">-</span></span>
<span id="cb44-18"><a href="plotting-images.html#cb44-18"></a><span class="st">                      </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>radiograph<span class="op">$</span>image))),</span>
<span id="cb44-19"><a href="plotting-images.html#cb44-19"></a>                    <span class="dt">xmax =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>image<span class="op">$</span>image))) <span class="op">+</span></span>
<span id="cb44-20"><a href="plotting-images.html#cb44-20"></a><span class="st">                      </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S2<span class="op">$</span>radiograph<span class="op">$</span>image)))</span>
<span id="cb44-21"><a href="plotting-images.html#cb44-21"></a>  ) <span class="op">+</span><span class="st"> </span></span>
<span id="cb44-22"><a href="plotting-images.html#cb44-22"></a><span class="st">    </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>radiograph<span class="op">$</span>image,</span>
<span id="cb44-23"><a href="plotting-images.html#cb44-23"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb44-24"><a href="plotting-images.html#cb44-24"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb44-25"><a href="plotting-images.html#cb44-25"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb44-26"><a href="plotting-images.html#cb44-26"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>xrf<span class="op">$</span>depth)<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb44-27"><a href="plotting-images.html#cb44-27"></a>                    <span class="dt">xmin =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>image<span class="op">$</span>image))) <span class="op">-</span></span>
<span id="cb44-28"><a href="plotting-images.html#cb44-28"></a><span class="st">                      </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>radiograph<span class="op">$</span>image))),</span>
<span id="cb44-29"><a href="plotting-images.html#cb44-29"></a>                    <span class="dt">xmax =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>image<span class="op">$</span>image))) <span class="op">+</span></span>
<span id="cb44-30"><a href="plotting-images.html#cb44-30"></a><span class="st">                      </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(CD166_<span class="dv">19</span>_S3<span class="op">$</span>radiograph<span class="op">$</span>image)))</span>
<span id="cb44-31"><a href="plotting-images.html#cb44-31"></a>  ) <span class="op">+</span></span>
<span id="cb44-32"><a href="plotting-images.html#cb44-32"></a><span class="st">    </span><span class="kw">theme</span>(<span class="dt">axis.title.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb44-33"><a href="plotting-images.html#cb44-33"></a>        <span class="dt">axis.text.x=</span><span class="kw">element_blank</span>(),</span>
<span id="cb44-34"><a href="plotting-images.html#cb44-34"></a>        <span class="dt">axis.ticks.x=</span><span class="kw">element_blank</span>())</span>
<span id="cb44-35"><a href="plotting-images.html#cb44-35"></a><span class="kw">print</span>(imagePlot <span class="op">+</span><span class="st"> </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="itraxBook_files/figure-html/add_radiographs-1.png" width="672" /></p>
<p>Finally, it may be necessary to plot the images horizontally rather than the more traditional vertical plots often used in down-core data presentation. <code>aperm()</code> and <code>t()</code> may be used for the optical and radiographic images respectively to transpose the x- and y-coordinates, but the images will need to be mirrored (using <code>[]</code>) so that the tops of the sections are on the right-hand side and the graphs run from oldest to youngest when read left-to-right, in the generally accepted order of these types of graph. For the example below, this is achieved in the first and second lines for the optical and radiographic images respectively.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="plotting-images.html#cb45-1"></a>mySidewaysImage &lt;-<span class="st"> </span><span class="kw">aperm</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>))[, <span class="kw">dim</span>(<span class="kw">aperm</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>image<span class="op">$</span>image, <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">3</span>)))[<span class="dv">2</span>]<span class="op">:</span><span class="dv">1</span>, ]</span>
<span id="cb45-2"><a href="plotting-images.html#cb45-2"></a>mySidewaysRadio &lt;-<span class="st"> </span><span class="kw">t</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>radiograph<span class="op">$</span>image)[, <span class="kw">dim</span>(<span class="kw">t</span>(CD166_<span class="dv">19</span>_S1<span class="op">$</span>radiograph<span class="op">$</span>image))[<span class="dv">2</span>]<span class="op">:</span><span class="dv">1</span>]</span>
<span id="cb45-3"><a href="plotting-images.html#cb45-3"></a></span>
<span id="cb45-4"><a href="plotting-images.html#cb45-4"></a><span class="kw">ggplot</span>() <span class="op">+</span></span>
<span id="cb45-5"><a href="plotting-images.html#cb45-5"></a><span class="st">  </span><span class="kw">xlim</span>(<span class="kw">rev</span>(<span class="kw">range</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(mySidewaysImage))))) <span class="op">+</span></span>
<span id="cb45-6"><a href="plotting-images.html#cb45-6"></a><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">breaks =</span> <span class="kw">round</span>(<span class="kw">range</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(mySidewaysImage))), <span class="dv">0</span>),</span>
<span id="cb45-7"><a href="plotting-images.html#cb45-7"></a>                     <span class="dt">limits =</span> <span class="kw">range</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(mySidewaysImage)))) <span class="op">+</span></span>
<span id="cb45-8"><a href="plotting-images.html#cb45-8"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;[mm]&quot;</span>, <span class="dt">x =</span> <span class="st">&quot;Position [mm]&quot;</span>) <span class="op">+</span></span>
<span id="cb45-9"><a href="plotting-images.html#cb45-9"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(mySidewaysImage,</span>
<span id="cb45-10"><a href="plotting-images.html#cb45-10"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb45-11"><a href="plotting-images.html#cb45-11"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb45-12"><a href="plotting-images.html#cb45-12"></a>                    <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(mySidewaysImage)))<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb45-13"><a href="plotting-images.html#cb45-13"></a>                    <span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(mySidewaysImage)))<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb45-14"><a href="plotting-images.html#cb45-14"></a>                    <span class="dt">ymin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(mySidewaysImage))),</span>
<span id="cb45-15"><a href="plotting-images.html#cb45-15"></a>                    <span class="dt">ymax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(mySidewaysImage)))</span>
<span id="cb45-16"><a href="plotting-images.html#cb45-16"></a>  ) <span class="op">+</span></span>
<span id="cb45-17"><a href="plotting-images.html#cb45-17"></a><span class="st">  </span><span class="kw">annotation_custom</span>(<span class="kw">rasterGrob</span>(mySidewaysRadio,</span>
<span id="cb45-18"><a href="plotting-images.html#cb45-18"></a>                               <span class="dt">width =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>),</span>
<span id="cb45-19"><a href="plotting-images.html#cb45-19"></a>                               <span class="dt">height =</span> <span class="kw">unit</span>(<span class="dv">1</span>, <span class="st">&quot;npc&quot;</span>)),</span>
<span id="cb45-20"><a href="plotting-images.html#cb45-20"></a>                    <span class="dt">xmax =</span> <span class="kw">max</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(mySidewaysRadio)))<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb45-21"><a href="plotting-images.html#cb45-21"></a>                    <span class="dt">xmin =</span> <span class="kw">min</span>(<span class="kw">as.numeric</span>(<span class="kw">colnames</span>(mySidewaysRadio)))<span class="op">/-</span><span class="dv">1</span>,</span>
<span id="cb45-22"><a href="plotting-images.html#cb45-22"></a>                    <span class="dt">ymin =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(mySidewaysImage))) <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(mySidewaysRadio))),</span>
<span id="cb45-23"><a href="plotting-images.html#cb45-23"></a>                    <span class="dt">ymax =</span> <span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(mySidewaysImage))) <span class="op">+</span><span class="st"> </span><span class="kw">mean</span>(<span class="kw">as.numeric</span>(<span class="kw">row.names</span>(mySidewaysRadio)))</span>
<span id="cb45-24"><a href="plotting-images.html#cb45-24"></a>  ) <span class="op">+</span></span>
<span id="cb45-25"><a href="plotting-images.html#cb45-25"></a><span class="st">  </span><span class="kw">coord_fixed</span>(<span class="dt">ratio =</span> <span class="dv">1</span>)</span></code></pre></div>
<p><img src="itraxBook_files/figure-html/sideways_plot-1.png" width="672" /></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="plotting-xrf-data.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="combining-images-with-xrf-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["itraxBook.pdf", "itraxBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
