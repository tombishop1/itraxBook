<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Importing Data | Using Itrax Data in R</title>
  <meta name="description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Importing Data | Using Itrax Data in R" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Importing Data | Using Itrax Data in R" />
  
  <meta name="twitter:description" content="This book is a guide to importing, tidying, manipulating and analysing Itrax core scanner data in R." />
  

<meta name="author" content="Thomas Bishop" />


<meta name="date" content="2020-06-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>
<link rel="next" href="tidying-data.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Using Itrax Data in R</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="0.1" data-path="index.html"><a href="index.html#why-did-i-write-this-book"><i class="fa fa-check"></i><b>0.1</b> Why did I write this book?</a></li>
<li class="chapter" data-level="0.2" data-path="index.html"><a href="index.html#prerequisites"><i class="fa fa-check"></i><b>0.2</b> Prerequisites</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Data Structure</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#metadata"><i class="fa fa-check"></i><b>1.1</b> Metadata</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#xrf-data"><i class="fa fa-check"></i><b>1.2</b> XRF Data</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#optical-images"><i class="fa fa-check"></i><b>1.3</b> Optical Images</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#radiographic-images"><i class="fa fa-check"></i><b>1.4</b> Radiographic Images</a></li>
<li class="chapter" data-level="1.5" data-path="intro.html"><a href="intro.html#magnetic-susceptability"><i class="fa fa-check"></i><b>1.5</b> Magnetic Susceptability</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="importing.html"><a href="importing.html"><i class="fa fa-check"></i><b>2</b> Importing Data</a><ul>
<li class="chapter" data-level="2.1" data-path="importing.html"><a href="importing.html#metadata-1"><i class="fa fa-check"></i><b>2.1</b> Metadata</a></li>
<li class="chapter" data-level="2.2" data-path="importing.html"><a href="importing.html#xrf-data-1"><i class="fa fa-check"></i><b>2.2</b> XRF Data</a><ul>
<li class="chapter" data-level="2.2.1" data-path="importing.html"><a href="importing.html#processed-data"><i class="fa fa-check"></i><b>2.2.1</b> Processed Data</a></li>
<li class="chapter" data-level="2.2.2" data-path="importing.html"><a href="importing.html#joining-xrf-data"><i class="fa fa-check"></i><b>2.2.2</b> Joining XRF Data</a></li>
<li class="chapter" data-level="2.2.3" data-path="importing.html"><a href="importing.html#raw-data"><i class="fa fa-check"></i><b>2.2.3</b> Raw Data</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="importing.html"><a href="importing.html#optical-images-1"><i class="fa fa-check"></i><b>2.3</b> Optical Images</a></li>
<li class="chapter" data-level="2.4" data-path="importing.html"><a href="importing.html#radiographic-images-1"><i class="fa fa-check"></i><b>2.4</b> Radiographic Images</a></li>
<li class="chapter" data-level="2.5" data-path="importing.html"><a href="importing.html#magnetic-susceptability-1"><i class="fa fa-check"></i><b>2.5</b> Magnetic Susceptability</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tidying-data.html"><a href="tidying-data.html"><i class="fa fa-check"></i><b>3</b> Tidying Data</a></li>
<li class="chapter" data-level="4" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>4</b> Plotting</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting.html"><a href="plotting.html#plotting-xrf-data"><i class="fa fa-check"></i><b>4.1</b> Plotting XRF Data</a></li>
<li class="chapter" data-level="4.2" data-path="plotting.html"><a href="plotting.html#plotting-images"><i class="fa fa-check"></i><b>4.2</b> Plotting Images</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="transforming-data.html"><a href="transforming-data.html"><i class="fa fa-check"></i><b>5</b> Transforming Data</a><ul>
<li class="chapter" data-level="5.1" data-path="transforming-data.html"><a href="transforming-data.html#ratios-and-normalisation"><i class="fa fa-check"></i><b>5.1</b> Ratios and Normalisation</a></li>
<li class="chapter" data-level="5.2" data-path="transforming-data.html"><a href="transforming-data.html#preparing-data-for-multivariate-data-analysis"><i class="fa fa-check"></i><b>5.2</b> Preparing Data for Multivariate Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multivariate-methods.html"><a href="multivariate-methods.html"><i class="fa fa-check"></i><b>6</b> Multivariate Methods</a><ul>
<li class="chapter" data-level="6.1" data-path="multivariate-methods.html"><a href="multivariate-methods.html#correlation-coefficients"><i class="fa fa-check"></i><b>6.1</b> Correlation Coefficients</a></li>
<li class="chapter" data-level="6.2" data-path="multivariate-methods.html"><a href="multivariate-methods.html#unconstrained-cluster-analysis"><i class="fa fa-check"></i><b>6.2</b> Unconstrained Cluster Analysis</a></li>
<li class="chapter" data-level="6.3" data-path="multivariate-methods.html"><a href="multivariate-methods.html#constrained-cluster-analaysis"><i class="fa fa-check"></i><b>6.3</b> Constrained Cluster Analaysis</a></li>
<li class="chapter" data-level="6.4" data-path="multivariate-methods.html"><a href="multivariate-methods.html#principle-components-analysis"><i class="fa fa-check"></i><b>6.4</b> Principle Components Analysis</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="calibrating-data.html"><a href="calibrating-data.html"><i class="fa fa-check"></i><b>7</b> Calibrating Data</a><ul>
<li class="chapter" data-level="7.1" data-path="calibrating-data.html"><a href="calibrating-data.html#suitable-methods"><i class="fa fa-check"></i><b>7.1</b> Suitable Methods</a></li>
<li class="chapter" data-level="7.2" data-path="calibrating-data.html"><a href="calibrating-data.html#linear-methods"><i class="fa fa-check"></i><b>7.2</b> Linear Methods</a></li>
<li class="chapter" data-level="7.3" data-path="calibrating-data.html"><a href="calibrating-data.html#log-ratio-methods"><i class="fa fa-check"></i><b>7.3</b> Log-Ratio Methods</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="transforming-data-1.html"><a href="transforming-data-1.html"><i class="fa fa-check"></i><b>8</b> Transforming Data</a><ul>
<li class="chapter" data-level="8.1" data-path="transforming-data-1.html"><a href="transforming-data-1.html#ratios-and-normalisation-1"><i class="fa fa-check"></i><b>8.1</b> Ratios and Normalisation</a></li>
<li class="chapter" data-level="8.2" data-path="transforming-data-1.html"><a href="transforming-data-1.html#preparing-data-for-multivariate-data-analysis-1"><i class="fa fa-check"></i><b>8.2</b> Preparing Data for Multivariate Data Analysis</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Using Itrax Data in R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="importing" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Importing Data</h1>
<<<<<<< HEAD
<p>All of the Itrax data is in either text-format or “tagged image format” (<code>*.tif</code>). Although this means it is easily read by the various import functions available in <code>R</code>, it still needs considerable cleaning and wrangling to get it to a point where it is useable for most analyses. There are three possible approaches to this task:</p>
<ol style="list-style-type: decimal">
<li>Use existing functions published in the <code>itraxR</code> package available from <a href="https://github.com/tombishop1/itraxR">github.com/tombishop1</a>. These are at an early stage and functionality might be broken, but are largely convenience functions for wrangling and analysing Itrax data.</li>
<li>Work in base <code>R</code> to wrangle the data. This is perfectly achievable, and much of the current <code>itraxR</code> functionality was written this way.</li>
<li>Work in the <code>tidyverse</code> family of packages and style. For data wrangling tasks, this approach can result in simpler and more resiliant code.</li>
</ol>
<p>In this guide examples will be given mostly using the <code>tidyverse</code>, and reference will be made to the convenience functions in <code>itraxR</code>.</p>
<div id="metadata-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Metadata</h2>
<p>The scan data file <code>document.txt</code> can be parsed using <code>itraxR::itrax_meta()</code>.</p>
=======
<p>All of the Itrax data is in either text-format or “tagged image format” (<code>*.tiff</code>). Although this means it is easily read by the various import functions available in <code>R</code>, it still needs considerable cleaning and wrangling to get it to a point where it is useable. A number of convienience functions are provided in the package <code>itraxR</code>.</p>
<div id="metadata-1" class="section level2">
<h2><span class="header-section-number">2.1</span> Metadata</h2>
<p>The scan data file <code>document.txt</code> can be read using <code>itraxR::itrax_meta()</code>. This is considerably easier than attempting to read it in a text editor, although this is possible.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">example</span>(itrax_meta)</a></code></pre></div>
<pre><code>## 
## itrx_m&gt; itrax_meta(system.file(&quot;extdata&quot;, &quot;document.txt&quot;, package = &quot;itraxR&quot;))
##                   Parameter     Value       Unit
## 1               Sample name WV17-2-D1        str
## 2              Section name WV17-2-D1        str
## 3           Aquisition date 24/1/2017 dd/mm/yyyy
## 4             Operator name       THB        str
## 5                      Tube        Mo    element
## 6          Start coordinate      27.3         mm
## 7           Stop coordinate    1064.3         mm
## 8                 Step size      2000    microns
## 9             Optical Start       0.1         mm
## 10              Optical End    1102.9         mm
## 11        Optical step size     0.047         mm
## 12             Rad. voltage        60         kV
## 13             Rad. current        40         mA
## 14            Rad. exposure       450         ms
## 15 line camera signal level    571116   at 25 ms
## 16                      XRF        ON     ON/OFF
## 17              XRF voltage        30         kV
## 18              XRF current        55         mA
## 19            XRF exp. time        10    seconds
## 20        Start temperature        26      \xb0C
## 21         Stop temperature        27      \xb0C
## 22           Start humidity        22          %
## 23            Stop humidity        21          %
## 24             Start vacuum     -96.0        kPa
## 25              Stop vacuum     -96.2        kPa</code></pre>
>>>>>>> 48d80c75e5272ceb7e9b5341d617b4eaec0466b7
</div>
<div id="xrf-data-1" class="section level2">
<h2><span class="header-section-number">2.2</span> XRF Data</h2>
<p>This is the data most commonly used in analysis and it can be quickly imported using <code>itraxR::itrax_import()</code>. If you’d like more control over the import process, a typical <code>Tidyverse</code> workflow would consist of reading the file (they are tab-delimited), removing variables that are not of interest, and correctly labelling data that should be <code>NA</code>. You may also wish to assign a coring depth information at this stage.</p>
<div id="processed-data" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Processed Data</h3>
<p>This process is integrated, along with some other functionality, in <code>itraxR::itrax_import()</code>.</p>
</div>
<div id="joining-xrf-data" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Joining XRF Data</h3>
<p>This process can be simplified using <code>itraxR::itrax_join()</code>.</p>
</div>
<div id="raw-data" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Raw Data</h3>
<p>Sometimes it is useful to work with raw data rather than the calculated intensity data from the <code>Q-Spec</code> software. In this case, the raw data can be read directly from the individual files in the relevant directory. For individual measurements this is fairly trivial, although it must be considered that the data output is not calibrated to an energy and the data are in counts, not intensities. If the entire scan is read, some mechanism to iterate through the individual data files, adding them to a structured data object with relevant metadata (positions, for example) is required.</p>
</div>
</div>
<div id="optical-images-1" class="section level2">
<h2><span class="header-section-number">2.3</span> Optical Images</h2>
<p>In order to make the images useable for plotting beside other data, they need to be cropped to the scanned area and referenced to the <code>position</code> or a <code>depth</code> variable. Images in <code>R</code> are read in as a matrix with 3 dimensions (length, width, and the three colours).</p>
<p>To begin with the start and end positions of the scan need to be established; this usually involves parsing the metadata file (e.g. <code>itraxR::itrax_meta()[]</code>), although in some circumstances they can be obtained from another data source (e.g. <code>range(myData[,&quot;Position&quot;])</code>). These then need to be mapped onto individual pixel values using the known size of a single pixel. Once this has been calculated, it is trvial to then subset the part of the image required.</p>
</div>
<div id="radiographic-images-1" class="section level2">
<h2><span class="header-section-number">2.4</span> Radiographic Images</h2>
<p>The workflow for manipulating the processed radiographic images (<code>*.tif</code>) is very similar to that for the optical images, the main difference being the matrix only has two dimensions (length and width) as the image is greyscale. However, if there is a desire to manipulate the raw data from the radiographic image, some further work is required because the “pixel” is not square, but rectangular. That is to say the length of the pixel differs from its width. On the core scanner a single pixel has a width across the core of 20 micrometers, but has a variable coverage along the core (usually between 50 and 200 micrometers). The processed image downscales the pixel width to match the pixel length in order to force square pixels, losing some resolution along the way.</p>
</div>
<div id="magnetic-susceptability-1" class="section level2">
<h2><span class="header-section-number">2.5</span> Magnetic Susceptability</h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tidying-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["itraxBook.pdf", "itraxBook.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
